function doRestore(){setTimeout(function(){$.mobile.changePage("#popup-msg",{role:"dialog"})},500);var e=parseInt(selectedRestoreFile[1]),l=null,o="local"===selectedRestoreFile[0]?"local":"cloud";if("local"===selectedRestoreFile[0])l=localFiles[e].fileName;else{l=cloudFiles[e].fileName;var t=null;if(cloudKey)t=cloudKey;else{var s=$("#cloudKey").val();32===s.length&&(t=s)}}$.ajax({url:"/api/"+club+"/restore",type:"POST",dataType:"json",data:{filename:l,restoreFrom:o,cloudKey:t},success:function(e){$(".ui-dialog").dialog("close"),e.success?alert("Your backup has been restored."):e.message&&alert("Your restore failed. "+e.message.toString())},error:function(e,l,o){$(".ui-dialog").dialog("close"),alert("Oops, something did not go right.")}})}function restoreClickHandler(){var e=$(this);selectedRestoreFile=e.attr("id").split("-"),2===selectedRestoreFile.length&&($.mobile.changePage("#popup-confirm",{role:"dialog"}),console.log(selectedRestoreFile))}var selectedRestoreFile=null;$(".btn-confirm").on("click",function(){$("#popup-confirm").dialog("close"),doRestore()}),$(".btn-restore").on("click",restoreClickHandler),$("#btn-viewcloud").on("click",function(){var e=null;if(cloudKey)e=cloudKey;else{var l=$("#cloudKey").val();32===l.length&&(e=l)}e?$.ajax({url:"/api/"+club+"/backup/cloud/"+e,type:"GET",dataType:"json",timeout:6e4,success:function(e){if(e.success){$("#lst-cloud").empty(),cloudFiles=e.files;for(var l=0;l<e.files.length;l++)$("#lst-cloud").append('<li><a class="btn-restore" id="cloud-'+l+'"><h3>'+e.files[l].fileName+"</h3><p>"+new Date(e.files[l].backupDate)+"</p></a></li>");$("#lst-cloud").listview("refresh"),$("#lst-cloud").find(".btn-restore").on("click",restoreClickHandler)}else alert(e.message)},error:function(e,l,o){alert("Are you connected to the Internet?\n\n"+l)}}):alert("You must enter a valid Cloud Key.")});