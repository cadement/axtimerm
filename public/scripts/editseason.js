function removeClass(e){var a=$(e),i=a.data("cname");$('div[data-cname="'+i+'"]').remove()}function removepClass(e){var a=$(e),i=a.data("pcname");console.log(i),$('div[data-pcname="'+i+'"]').remove()}function addClass(e,a,i,d){var t='<div class="ui-block-a ui-btn-inner axclassname" data-cname="'+e+'" style="font-weight:bold;">'+e+'</div><div class="ui-block-b" data-cname="'+e+'" style="padding-right:20px;"><input type="text" id="'+e+'--index" value="'+a+'" style="margin-top:0px;"/></div><div class="ui-block-c" data-cname="'+e+'"><select data-role="slider" id="'+e+'--ladies"><option value="no"'+(i?"":' selected="selected"')+'>No</option><option value="yes"'+(i?' selected="selected"':"")+'>Yes</option></select></div><div class="ui-block-c" data-cname="'+e+'"><select data-role="slider" id="'+e+'--stock"><option value="no"'+(d?"":' selected="selected"')+'>No</option><option value="yes"'+(d?' selected="selected"':"")+'>Yes</option></select></div><div class="ui-block-d" data-cname="'+e+'"><a class="btn-classremove"data-role="button" data-theme="e" style="cursor:pointer" data-cname="'+e+'">Remove</a></div>';$(t).appendTo("#classlist").trigger("create")}$(document).bind("pageinit",function(){function e(e,a,i,d){var t='<div class="ui-block-a paxclassname" data-pcname="'+e+'" style="padding-right:20px;"><input type="text" id="'+e+'--pname" value="'+e+'" style="margin-top:0px;"/></div><div class="ui-block-b" data-pcname="'+e+'" style="padding-right:20px;"><input type="text" id="'+e+'--pcategory" value="'+a+'" style="margin-top:0px;"/></div> <div class="ui-block-c" data-pcname="'+e+'" style="padding-right:20px;"><input type="text" id="'+e+'--pdescription" value="'+d+'" style="margin-top:0px;"/></div><div class="ui-block-d" data-pcname="'+e+'"><select data-role="slider" id="'+e+'--pladies"><option value="no"'+(i?"":' selected="selected"')+'>No</option><option value="yes"'+(i?' selected="selected"':"")+'>Yes</option></select></div><div class="ui-block-e" data-pcname="'+e+'"><a class="btn-pclassremove"data-role="button" data-theme="e" style="cursor:pointer" data-pcname="'+e+'">Remove</a></div>';$(t).appendTo("#pclasslist").trigger("create")}$(".btn-fill").bind("click",function(){var e=$(this).data("set").split("-"),a={season:2013,classes:{SS:{index:.859,category:"Stock"},AS:{index:.847,category:"Stock"},BS:{index:.845,category:"Stock"},CS:{index:.834,category:"Stock"},DS:{index:.826,category:"Stock"},ES:{index:.828,category:"Stock"},FS:{index:.83,category:"Stock"},GS:{index:.816,category:"Stock"},HS:{index:.804,category:"Stock"},SSP:{index:.871,category:"Street Prepared"},ASP:{index:.866,category:"Street Prepared"},BSP:{index:.858,category:"Street Prepared"},CSP:{index:.861,category:"Street Prepared"},DSP:{index:.855,category:"Street Prepared"},ESP:{index:.849,category:"Street Prepared"},FSP:{index:.838,category:"Street Prepared"},STF:{index:.795,category:"Touring"},STC:{index:.824,category:"Touring"},STS:{index:.829,category:"Touring"},STR:{index:.839,category:"Touring"},STX:{index:.827,category:"Touring"},STU:{index:.846,category:"Touring"},XP:{index:.901,category:"Prepared"},BP:{index:.878,category:"Prepared"},CP:{index:.862,category:"Prepared"},DP:{index:.874,category:"Prepared"},EP:{index:.875,category:"Prepared"},FP:{index:.877,category:"Prepared"},GP:{index:.85,category:"Prepared"},SM:{index:.867,category:"Street Modified"},SMF:{index:.852,category:"Street Modified"},SSM:{index:.881,category:"Street Modified"},AM:{index:1,category:"Modified"},BM:{index:.962,category:"Modified"},CM:{index:.91,category:"Modified"},DM:{index:.918,category:"Modified"},EM:{index:.928,category:"Modified"},FM:{index:.917,category:"Modified"},FSAE:{index:.989,category:"Formula"},KM:{index:.955,category:"Kart"},JA:{index:.879,category:"Junior Kart"},JB:{index:.842,category:"Junior Kart"},JC:{index:.743,category:"Junior Kart"}}},i={season:2012,classes:{SS:{index:.858,category:"Stock"},AS:{index:.844,category:"Stock"},BS:{index:.843,category:"Stock"},CS:{index:.833,category:"Stock"},DS:{index:.821,category:"Stock"},ES:{index:.828,category:"Stock"},FS:{index:.825,category:"Stock"},GS:{index:.814,category:"Stock"},HS:{index:.799,category:"Stock"},SSP:{index:.865,category:"Street Prepared"},ASP:{index:.863,category:"Street Prepared"},BSP:{index:.859,category:"Street Prepared"},CSP:{index:.857,category:"Street Prepared"},DSP:{index:.851,category:"Street Prepared"},ESP:{index:.848,category:"Street Prepared"},FSP:{index:.838,category:"Street Prepared"},STF:{index:.794,category:"Touring"},STC:{index:.82,category:"Touring"},STS:{index:.827,category:"Touring"},STR:{index:.835,category:"Touring"},STX:{index:.822,category:"Touring"},STU:{index:.841,category:"Touring"},XP:{index:.898,category:"Prepared"},BP:{index:.873,category:"Prepared"},CP:{index:.86,category:"Prepared"},DP:{index:.868,category:"Prepared"},EP:{index:.87,category:"Prepared"},FP:{index:.875,category:"Prepared"},GP:{index:.85,category:"Prepared"},SM:{index:.866,category:"Street Modified"},SMF:{index:.852,category:"Street Modified"},SSM:{index:.879,category:"Street Modified"},AM:{index:1,category:"Modified"},BM:{index:.96,category:"Modified"},CM:{index:.906,category:"Modified"},DM:{index:.915,category:"Modified"},EM:{index:.928,category:"Modified"},FM:{index:.913,category:"Modified"},FSAE:{index:.989,category:"Formula"},KM:{index:.952,category:"Kart"},JA:{index:.876,category:"Junior Kart"},JB:{index:.834,category:"Junior Kart"},JC:{index:.747,category:"Junior Kart"}}},d=3==e.length;if("scca"==e[0]&&"2013"==e[1]){$("#classlist").empty(),$("#classlist").append('<div class="ui-block-a">Name</div><div class="ui-block-b">Index</div><div class="ui-block-c">Ladies Only</div><div class="ui-block-d">Stock</div><div class="ui-block-e"></div>');for(var t in a.classes)addClass(t,a.classes[t].index,!1,!1),d&&addClass(t+"L",a.classes[t].index,!0,!1)}else if("scca"==e[0]&&"2012"==e[1]){$("#classlist").empty(),$("#classlist").append('<div class="ui-block-a">Name</div><div class="ui-block-b">Index</div><div class="ui-block-c">Ladies Only</div><div class="ui-block-d">Stock</div><div class="ui-block-e"></div>');for(var t in i.classes)addClass(t,i.classes[t].index,!1,!1),d&&addClass(t+"L",i.classes[t].index,!0,!1)}$("#dlg-prefill").popup("close")}),$("#btn-addcls").click(function(){var e=$("#addcls-name").val(),a=$("#addcls-index").val(),i="yes"==$("#addcls-ladies").val(),d="yes"==$("#addcls-stock").val();addClass(e,a,i,d),$("#addcls-name").val(""),$("#addcls-index").val("1"),$("#addcls-ladies").val("no"),$("#addcls-stock").val("no")}),$("#btn-addpcls").click(function(){var a=$("#addpcls-name").val(),i=$("#addpcls-category").val(),d="yes"==$("#addpcls-ladies").val(),t=$("#addpcls-description").val();e(a,i,d,t),$("#addpcls-name").val(""),$("#addpcls-category").val(""),$("#addpcls-ladies").val("no"),$("#addpcls-description").val("")}),$(".btn-classremove").bind("click",function(){removeClass(this)}),$(".btn-pclassremove").bind("click",function(){removepClass(this)}),$("#btn-save").click(function(){var e=$("#year").val(),a=$("#maxpax").val(),d=$("#maxclass").val(),a=$("#maxpax").val(),t=$("input[name=classcalc]:checked").val(),c=$("#classMinPoints").val(),o=$("#paxMinPoints").val(),s=$("#eventsToQualify").val(),n=[],r=[],l=parseInt($("#conepenalty").val()),p=[],g=[],x=[];for($(".axclassname").each(function(e,a){var i=$(a).text(),e=$("#"+i+"--index").val(),d="yes"==$("#"+i+"--ladies").val(),t="yes"==$("#"+i+"--stock").val();g.push({name:i,index:e,isLadies:d,isStock:t})}),$(".paxclassname").each(function(e,a){var i=$(this).data("pcname"),d=$("#"+i+"--pname").val(),t=$("#"+i+"--pcategory").val(),c=$("#"+i+"--pdescription").val(),o="yes"==$("#"+i+"--pladies").val();x.push({name:d,category:t,isLadies:o,description:c})}),i=1;i<=10;i++){var y=parseInt($("#cp-"+i).val());if(!(y>0))break;n.push(y)}for(i=1;i<=30;i++){var y=parseInt($("#pp-"+i).val());if(!(y>0))break;r.push(y)}0==p.length?$.ajax({url:"/api/season/"+cid,type:"POST",dataType:"json",data:{year:e,maxcls:d,maxpax:a,classes:g,clspts:n,paxpts:r,conepen:l,paxclasses:x,eventsToQualify:s,classCalc:t,paxMinPoints:o,classMinPoints:c},success:function(e){console.log(e),"success"==e.status?$.mobile.changePage("/club/"+clubname+"/manageseasons",{transition:"none"}):alert(e.message)}}):alert("Invalid: "+p.join(", "))})});