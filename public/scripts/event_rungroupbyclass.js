!function(){function s(s){for(var r=0;r<runGroups.length;r++)if(runGroups[r].name==s)return r;return-1}function r(){for(var s=$("#classes").empty(),r=0;r<classRunGroups.length;r++){var n=classRunGroups[r],u=$('<div class="rg-class '+(n.runGroup?"taken":"")+'" id="class-'+r+'" data-ix="'+r+'" data-n="'+r+'"><div class="rg-pick-cls" style="background-color:'+n.runGroup+'"></div><div class="rg-pick-name">'+(n.paxClass||n.baseClass)+" ("+n.count+")</div></div>");u.on("click",o),s.append(u)}}function n(s){classRunGroups[s].runGroupIx=t;var r=$("#class-"+s);r.toggleClass("selected",!0).toggleClass("taken",!1),r.find(".rg-pick-cls").css("background-color",runGroups[t].color)}function u(s){classRunGroups[s].runGroupIx=-1;var r=$("#class-"+s);r.toggleClass("selected",!1).toggleClass("taken",!1),r.find(".rg-pick-cls").css("background-color","inherit")}function o(){if(document.getSelection().removeAllRanges(),-1==t)alert("You must first select a Run Group on the left.");else{var s=$(this),r=s.data("n"),o=s.data("ix");if(t==classRunGroups[o].runGroupIx)u(o);else if(n(o),a)if(o>l)for(var c=l;o>=c;c++)n(c);else if(l>o)for(var c=l;c>=o;c--)n(c);e(),l=r}}function e(){for(var s=classRunGroups.length,r=0,n=[],u=0;u<runGroups.length;u++)n[u]=0;for(var u=0;s>u;u++)classRunGroups[u].runGroupIx>-1&&(r++,n[classRunGroups[u].runGroupIx]+=classRunGroups[u].count);s==r?$("#btn-doit").button("enable"):$("#btn-doit").button("disable");for(var u=0;u<runGroups.length;u++)$("#rg-"+u).find(".num").text(" - "+n[u]);return s==r}for(var a=!1,t=-1,l=0,c=0;c<classRunGroups.length;c++)classRunGroups[c].runGroupIx=s(classRunGroups[c].runGroup);$(".rg-item").on("click",function(){$(".rg-item").attr("style","").removeClass("selected");var s=parseInt($(this).data("ix")),r=runGroups[s].color;t=s,$(this).attr("style","background-color:"+r).addClass("selected");for(var n=0;n<classRunGroups.length;n++){var u=(classRunGroups[n],classRunGroups[n].runGroupIx==s),o=classRunGroups[n].runGroupIx>-1&&!u;$("#class-"+n).toggleClass("selected",u).toggleClass("taken",o)}}),$("#btn-doit").on("click",function(){if(e()){var s={doExisting:"yes"==$("#doexisting").val(),classRunGroups:classRunGroups};$.ajax({type:"POST",url:"/api/event/"+eventId+"/assignrungroups",dataType:"json",data:s,success:function(s){s.success?alert("Your Run Groups have been assigned successfully!"):alert("There was a problem assigning your Run Groups. "+s.message)},error:function(){alert("Oops, there was a problem communicating with the system or a fatal error")}})}else alert("Oops, each class must be assigned to a run group.")}),$(document).on("ready",function(){r(),e()}),$(document).on("keydown",function(s){16===s.which&&(a=!0,s.preventDefault())}),$(document).on("keyup",function(){a=!1})}();