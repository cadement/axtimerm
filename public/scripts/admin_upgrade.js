function upgradeClick(){$(".ui-dialog").dialog("close");var e=(new Date).getTime();setTimeout(function(){$.mobile.loading("show",{text:"Please be patient while we upgrade your system.",textVisible:!0}),$.ajax({url:"/api/upgrade/"+buildId,type:"POST",dataType:"json",timeout:6e5,success:function(t){$.mobile.loading("hide"),t.success?($.mobile.changePage("#dlg-finished",{role:"dialog"}),$("#finished-msg").text("Completed in "+((new Date).getTime()-e)+"ms")):alert(t.message)},error:function(e,t,i){alert(i)}})},500)}function buildClick(){buildId=$(this).data("buildid");var e=$(this).data("ix"),t=builds[e];console.log(t),$("#version").text(t.version),$.mobile.changePage("#dlg-confirm",{role:"dialog"})}var buildId=null,builds=[];$("#btn-confirm").on("click",upgradeClick),$(document).on("ready",function(){$.ajax({url:"/api/upgrade/builds",type:"GET",dataType:"json",success:function(e){if($("#checking").hide(),e.success){builds=e.builds;var t=$("#buildsdiv").empty(),i=[];if(0===builds.length)t.html('<div style="padding:12px;"><span>You are running the most recent version.</span></div>');else{for(var a=0;a<e.builds.length;a++){var n=e.builds[a];i.push('<div style="padding:12px;clear:both;border-bottom:solid 1px silver"><div style="width:49%;float:left;padding-top:12px;"><strong style="font-size:1.3em;">'+n.version+"</strong><br/>"+n.dateUploaded+'</div><div style="width:49%;float:right;text-align:right;"><button class="btn-upgrade" data-buildid="'+n.id+'" data-ix="'+a+'" data-role="button" data-inline="true" data-theme="b">Upgrade</button><a href="'+n.releaseNotesUrl+'" target="_blank" data-role="button" data-inline="true">Release Notes</a></div><div style="clear:both;"></div></div>')}t.append(i.join("")),t.find('a[data-role="button"]').buttonMarkup("refresh"),t.find(".btn-upgrade").buttonMarkup("refresh").on("click",buildClick)}}else alert(e.message)},error:function(e,t,i){alert(i)}})});var socket=io();socket.on("reconnecting",function(){}),socket.on("connect",function(){socket.emit("join",{stream:"admin"}),$("#messages").empty()}),socket.on("adminmsg",function(e){$("#messages").append("<p>"+e+"</p>")});